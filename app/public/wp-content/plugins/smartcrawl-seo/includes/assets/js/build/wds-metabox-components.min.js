(()=>{"use strict";var e={};function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t(e)}function n(e,n){for(var r=0;r<n.length;r++){var o=n[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,(i=o.key,a=void 0,a=function(e,n){if("object"!==t(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,n||"default");if("object"!==t(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(e)}(i,"string"),"symbol"===t(a)?a:String(a)),o)}var i,a}e.n=t=>{var n=t&&t.__esModule?()=>t.default:()=>t;return e.d(n,{a:n}),n},e.d=(t,n)=>{for(var r in n)e.o(n,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:n[r]})},e.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);const r=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.taxonomies={}}var t,r,o;return t=e,(r=[{key:"set_id",value:function(e){return this.id=e,this}},{key:"get_id",value:function(){return this.id}},{key:"set_type",value:function(e){return this.type=e,this}},{key:"get_type",value:function(){return this.type}},{key:"set_author_id",value:function(e){return this.author_id=e,this}},{key:"get_author_id",value:function(){return this.author_id}},{key:"set_title",value:function(e){return this.title=e,this}},{key:"get_title",value:function(){return this.title}},{key:"set_content",value:function(e){return this.content=e,this}},{key:"get_content",value:function(){return this.content}},{key:"set_excerpt",value:function(e){return this.excerpt=e,this}},{key:"get_excerpt",value:function(){return this.excerpt}},{key:"set_category_ids",value:function(e){return this.set_taxonomy_terms("category",e),this}},{key:"get_category_ids",value:function(){return this.get_taxonomy_terms("category")}},{key:"set_tag_ids",value:function(e){return this.set_taxonomy_terms("post_tag",e),this}},{key:"get_tag_ids",value:function(){return this.get_taxonomy_terms("post_tag")}},{key:"set_slug",value:function(e){return this.slug=e,this}},{key:"get_slug",value:function(){return this.slug}},{key:"set_date",value:function(e){return this.date=e,this}},{key:"get_date",value:function(){return this.date}},{key:"set_modified",value:function(e){return this.modified=e,this}},{key:"get_modified",value:function(){return this.modified}},{key:"set_permalink",value:function(e){return this.permalink=e,this}},{key:"get_permalink",value:function(){return this.permalink}},{key:"set_taxonomy_terms",value:function(e,t){this.taxonomies[e]=t}},{key:"get_taxonomy_terms",value:function(e){return this.taxonomies.hasOwnProperty(e)?this.taxonomies[e]:[]}}])&&n(t.prototype,r),o&&n(t,o),Object.defineProperty(t,"prototype",{writable:!1}),e}(),o=wp;var i=e.n(o);const a=_;var s=e.n(a);const u=jQuery;var c=e.n(u);function l(e){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l(e)}function f(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(o=r.key,i=void 0,i=function(e,t){if("object"!==l(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==l(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(o,"string"),"symbol"===l(i)?i:String(i)),r)}var o,i}var d=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"general";Array.isArray(e)||(e=[e]);var n=window["_wds_"+t]||{};return e.forEach((function(e){n=n&&n.hasOwnProperty(e)?n[e]:""})),n}},{key:"get_bool",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"general";return!!this.get(e,t)}}],(n=null)&&f(t.prototype,n),r&&f(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();const p=d;function y(e,t,...n){if(!e)throw new TypeError(h(t,n))}function h(e,t){let n=0;return e.replace(/%[os]/gu,(()=>g(t[n++])))}function g(e){return"object"!=typeof e||null===e?String(e):Object.prototype.toString.call(e)}let v;const m="undefined"!=typeof window?window:"undefined"!=typeof self?self:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:void 0;let b;class w{constructor(e,t){this.code=e,this.message=t}warn(...e){var t;try{if(b)return void b({...this,args:e});const n=(null!==(t=(new Error).stack)&&void 0!==t?t:"").replace(/^(?:.+?\n){2}/gu,"\n");console.warn(this.message,...e,n)}catch(e){}}}const k=new w("W01","Unable to initialize event under dispatching."),E=new w("W02","Assigning any falsy value to 'cancelBubble' property has no effect."),P=new w("W03","Assigning any truthy value to 'returnValue' property has no effect."),O=new w("W04","Unable to preventDefault on non-cancelable events."),S=new w("W05","Unable to preventDefault inside passive event listener invocation."),j=new w("W06","An event listener wasn't added because it has been added already: %o, %o"),x=new w("W07","The %o option value was abandoned because the event listener wasn't added as duplicated."),R=new w("W08","The 'callback' argument must be a function or an object that has 'handleEvent' method: %o");new w("W09","Event attribute handler must be a function: %o");class T{static get NONE(){return A}static get CAPTURING_PHASE(){return I}static get AT_TARGET(){return C}static get BUBBLING_PHASE(){return D}constructor(e,t){Object.defineProperty(this,"isTrusted",{value:!1,enumerable:!0});const n=null!=t?t:{};N.set(this,{type:String(e),bubbles:Boolean(n.bubbles),cancelable:Boolean(n.cancelable),composed:Boolean(n.composed),target:null,currentTarget:null,stopPropagationFlag:!1,stopImmediatePropagationFlag:!1,canceledFlag:!1,inPassiveListenerFlag:!1,dispatchFlag:!1,timeStamp:Date.now()})}get type(){return B(this).type}get target(){return B(this).target}get srcElement(){return B(this).target}get currentTarget(){return B(this).currentTarget}composedPath(){const e=B(this).currentTarget;return e?[e]:[]}get NONE(){return A}get CAPTURING_PHASE(){return I}get AT_TARGET(){return C}get BUBBLING_PHASE(){return D}get eventPhase(){return B(this).dispatchFlag?2:0}stopPropagation(){B(this).stopPropagationFlag=!0}get cancelBubble(){return B(this).stopPropagationFlag}set cancelBubble(e){e?B(this).stopPropagationFlag=!0:E.warn()}stopImmediatePropagation(){const e=B(this);e.stopPropagationFlag=e.stopImmediatePropagationFlag=!0}get bubbles(){return B(this).bubbles}get cancelable(){return B(this).cancelable}get returnValue(){return!B(this).canceledFlag}set returnValue(e){e?P.warn():F(B(this))}preventDefault(){F(B(this))}get defaultPrevented(){return B(this).canceledFlag}get composed(){return B(this).composed}get isTrusted(){return!1}get timeStamp(){return B(this).timeStamp}initEvent(e,t=!1,n=!1){const r=B(this);r.dispatchFlag?k.warn():N.set(this,{...r,type:String(e),bubbles:Boolean(t),cancelable:Boolean(n),target:null,currentTarget:null,stopPropagationFlag:!1,stopImmediatePropagationFlag:!1,canceledFlag:!1})}}const A=0,I=1,C=2,D=3,N=new WeakMap;function B(e,t="this"){const n=N.get(e);return y(null!=n,"'%s' must be an object that Event constructor created, but got another one: %o",t,e),n}function F(e){e.inPassiveListenerFlag?S.warn():e.cancelable?e.canceledFlag=!0:O.warn()}Object.defineProperty(T,"NONE",{enumerable:!0}),Object.defineProperty(T,"CAPTURING_PHASE",{enumerable:!0}),Object.defineProperty(T,"AT_TARGET",{enumerable:!0}),Object.defineProperty(T,"BUBBLING_PHASE",{enumerable:!0});const L=Object.getOwnPropertyNames(T.prototype);for(let e=0;e<L.length;++e)"constructor"!==L[e]&&Object.defineProperty(T.prototype,L[e],{enumerable:!0});let W;void 0!==m&&void 0!==m.Event&&Object.setPrototypeOf(T.prototype,m.Event.prototype);const U={INDEX_SIZE_ERR:1,DOMSTRING_SIZE_ERR:2,HIERARCHY_REQUEST_ERR:3,WRONG_DOCUMENT_ERR:4,INVALID_CHARACTER_ERR:5,NO_DATA_ALLOWED_ERR:6,NO_MODIFICATION_ALLOWED_ERR:7,NOT_FOUND_ERR:8,NOT_SUPPORTED_ERR:9,INUSE_ATTRIBUTE_ERR:10,INVALID_STATE_ERR:11,SYNTAX_ERR:12,INVALID_MODIFICATION_ERR:13,NAMESPACE_ERR:14,INVALID_ACCESS_ERR:15,VALIDATION_ERR:16,TYPE_MISMATCH_ERR:17,SECURITY_ERR:18,NETWORK_ERR:19,ABORT_ERR:20,URL_MISMATCH_ERR:21,QUOTA_EXCEEDED_ERR:22,TIMEOUT_ERR:23,INVALID_NODE_TYPE_ERR:24,DATA_CLONE_ERR:25};function q(e){const t=Object.keys(U);for(let n=0;n<t.length;++n){const r=t[n],o=U[r];Object.defineProperty(e,r,{get:()=>o,configurable:!0,enumerable:!0})}}class M extends T{static wrap(e){return new(H(e))(e)}constructor(e){super(e.type,{bubbles:e.bubbles,cancelable:e.cancelable,composed:e.composed}),e.cancelBubble&&super.stopPropagation(),e.defaultPrevented&&super.preventDefault(),V.set(this,{original:e});const t=Object.keys(e);for(let n=0;n<t.length;++n){const r=t[n];r in this||Object.defineProperty(this,r,z(e,r))}}stopPropagation(){super.stopPropagation();const{original:e}=$(this);"stopPropagation"in e&&e.stopPropagation()}get cancelBubble(){return super.cancelBubble}set cancelBubble(e){super.cancelBubble=e;const{original:t}=$(this);"cancelBubble"in t&&(t.cancelBubble=e)}stopImmediatePropagation(){super.stopImmediatePropagation();const{original:e}=$(this);"stopImmediatePropagation"in e&&e.stopImmediatePropagation()}get returnValue(){return super.returnValue}set returnValue(e){super.returnValue=e;const{original:t}=$(this);"returnValue"in t&&(t.returnValue=e)}preventDefault(){super.preventDefault();const{original:e}=$(this);"preventDefault"in e&&e.preventDefault()}get timeStamp(){const{original:e}=$(this);return"timeStamp"in e?e.timeStamp:super.timeStamp}}const V=new WeakMap;function $(e){const t=V.get(e);return y(null!=t,"'this' is expected an Event object, but got",e),t}const G=new WeakMap;function H(e){const t=Object.getPrototypeOf(e);if(null==t)return M;let n=G.get(t);return null==n&&(n=function(e,t){class n extends e{}const r=Object.keys(t);for(let e=0;e<r.length;++e)Object.defineProperty(n.prototype,r[e],z(t,r[e]));return n}(H(t),t),G.set(t,n)),n}function z(e,t){const n=Object.getOwnPropertyDescriptor(e,t);return{get(){const e=$(this).original,n=e[t];return"function"==typeof n?n.bind(e):n},set(e){$(this).original[t]=e},configurable:n.configurable,enumerable:n.enumerable}}function Y(e){return 1==(1&e.flags)}function Q(e){return 2==(2&e.flags)}function Z(e){return 4==(4&e.flags)}function X(e){return 8==(8&e.flags)}function K({callback:e},t,n){try{"function"==typeof e?e.call(t,n):"function"==typeof e.handleEvent&&e.handleEvent(n)}catch(e){!function(e){try{const t=e instanceof Error?e:new Error(g(e));if(v)return void v(t);if("function"==typeof dispatchEvent&&"function"==typeof ErrorEvent)dispatchEvent(new ErrorEvent("error",{error:t,message:t.message}));else if("undefined"!=typeof process&&"function"==typeof process.emit)return void process.emit("uncaughtException",t);console.error(t)}catch(e){}}(e)}}function J({listeners:e},t,n){for(let r=0;r<e.length;++r)if(e[r].callback===t&&Y(e[r])===n)return r;return-1}function ee(e,t,n,r,o,i){let a;i&&(a=te.bind(null,e,t,n),i.addEventListener("abort",a));const s=function(e,t,n,r,o,i){return{callback:e,flags:(t?1:0)|(n?2:0)|(r?4:0),signal:o,signalListener:i}}(t,n,r,o,i,a);return e.cow?(e.cow=!1,e.listeners=[...e.listeners,s]):e.listeners.push(s),s}function te(e,t,n){const r=J(e,t,n);return-1!==r&&ne(e,r)}function ne(e,t,n=!1){const r=e.listeners[t];return function(e){e.flags|=8}(r),r.signal&&r.signal.removeEventListener("abort",r.signalListener),e.cow&&!n?(e.cow=!1,e.listeners=e.listeners.filter(((e,n)=>n!==t)),!1):(e.listeners.splice(t,1),!0)}function re(e,t){var n;return null!==(n=e[t])&&void 0!==n?n:e[t]={attrCallback:void 0,attrListener:void 0,cow:!1,listeners:[]}}G.set(Object.prototype,M),void 0!==m&&void 0!==m.Event&&G.set(m.Event.prototype,M);class oe{constructor(){ie.set(this,Object.create(null))}addEventListener(e,t,n){const r=ae(this),{callback:o,capture:i,once:a,passive:s,signal:u,type:c}=function(e,t,n){var r;if(se(t),"object"==typeof n&&null!==n)return{type:String(e),callback:null!=t?t:void 0,capture:Boolean(n.capture),passive:Boolean(n.passive),once:Boolean(n.once),signal:null!==(r=n.signal)&&void 0!==r?r:void 0};return{type:String(e),callback:null!=t?t:void 0,capture:Boolean(n),passive:!1,once:!1,signal:void 0}}(e,t,n);if(null==o||(null==u?void 0:u.aborted))return;const l=re(r,c),f=J(l,o,i);-1===f?ee(l,o,i,s,a,u):function(e,t,n,r){j.warn(Y(e)?"capture":"bubble",e.callback),Q(e)!==t&&x.warn("passive");Z(e)!==n&&x.warn("once");e.signal!==r&&x.warn("signal")}(l.listeners[f],s,a,u)}removeEventListener(e,t,n){const r=ae(this),{callback:o,capture:i,type:a}=function(e,t,n){if(se(t),"object"==typeof n&&null!==n)return{type:String(e),callback:null!=t?t:void 0,capture:Boolean(n.capture)};return{type:String(e),callback:null!=t?t:void 0,capture:Boolean(n)}}(e,t,n),s=r[a];null!=o&&s&&te(s,o,i)}dispatchEvent(e){const t=ae(this)[String(e.type)];if(null==t)return!0;const n=e instanceof T?e:M.wrap(e),r=B(n,"event");if(r.dispatchFlag)throw o="This event has been in dispatching.",m.DOMException?new m.DOMException(o,"InvalidStateError"):(null==W&&(W=class e extends Error{constructor(t){super(t),Error.captureStackTrace&&Error.captureStackTrace(this,e)}get code(){return 11}get name(){return"InvalidStateError"}},Object.defineProperties(W.prototype,{code:{enumerable:!0},name:{enumerable:!0}}),q(W),q(W.prototype)),new W(o));var o;if(r.dispatchFlag=!0,r.target=r.currentTarget=this,!r.stopPropagationFlag){const{cow:e,listeners:o}=t;t.cow=!0;for(let i=0;i<o.length;++i){const a=o[i];if(!X(a)&&(Z(a)&&ne(t,i,!e)&&(i-=1),r.inPassiveListenerFlag=Q(a),K(a,this,n),r.inPassiveListenerFlag=!1,r.stopImmediatePropagationFlag))break}e||(t.cow=!1)}return r.target=null,r.currentTarget=null,r.stopImmediatePropagationFlag=!1,r.stopPropagationFlag=!1,r.dispatchFlag=!1,!r.canceledFlag}}const ie=new WeakMap;function ae(e,t="this"){const n=ie.get(e);return y(null!=n,"'%s' must be an object that EventTarget constructor created, but got another one: %o",t,e),n}function se(e){if("function"!=typeof e&&("object"!=typeof e||null===e||"function"!=typeof e.handleEvent)){if(null!=e&&"object"!=typeof e)throw new TypeError(h(R.message,[e]));R.warn(e)}}const ue=Object.getOwnPropertyNames(oe.prototype);for(let e=0;e<ue.length;++e)"constructor"!==ue[e]&&Object.defineProperty(oe.prototype,ue[e],{enumerable:!0});void 0!==m&&void 0!==m.EventTarget&&Object.setPrototypeOf(oe.prototype,m.EventTarget.prototype);function ce(e){return ce="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ce(e)}function le(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(o=r.key,i=void 0,i=function(e,t){if("object"!==ce(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==ce(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(o,"string"),"symbol"===ce(i)?i:String(i)),r)}var o,i}function fe(e,t){return fe=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},fe(e,t)}function de(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=_e(e);if(t){var o=_e(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===ce(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function _e(e){return _e=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},_e(e)}const pe=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&fe(e,t)}(u,e);var t,n,o,a=de(u);function u(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),(e=a.call(this)).init(),e}return t=u,(n=[{key:"init",value:function(){var e=this;c()(document).on("input","input#title,textarea#content,textarea#excerpt",this.get_debounced_change_callback()).on("after-autosave.smartcrawl",(function(){return e.dispatch_autosave_event()})),c()(window).on("load",(function(){return e.hook_tinymce_change_listener()}))}},{key:"get_data",value:function(){var e=i().autosave.getPostData(),t=new r,n=c()("#tax-input-post_tag").val();return t.set_id(e.post_id).set_type(e.post_type).set_author_id(e.post_author).set_title(e.post_title).set_content(e.content).set_excerpt(e.excerpt).set_category_ids(e.catslist.split(",")).set_tag_ids(n?n.split(","):[]).set_slug(e.post_name).set_date(new Date).set_modified(new Date).set_permalink(p.get("post_url","metabox"))}},{key:"dispatch_content_change_event",value:function(){this.dispatchEvent(new Event("content-change"))}},{key:"hook_tinymce_change_listener",value:function(){var e="undefined"!=typeof tinymce&&tinymce.get("content");e&&e.on("change",this.get_debounced_change_callback())}},{key:"get_debounced_change_callback",value:function(){var e=this;return s().debounce((function(){return e.dispatch_content_change_event()}),2e3)}},{key:"dispatch_autosave_event",value:function(){this.dispatchEvent(new Event("autosave"))}},{key:"autosave",value:function(){var e=this;c()(document).off("after-autosave.smartcrawl"),c()(document).one("heartbeat-tick.autosave",(function(){e.dispatch_autosave_event(),c()(document).on("after-autosave.smartcrawl",(function(){return e.dispatch_autosave_event()}))})),this.trigger_tinymce_save(),i().autosave.server.triggerSave()}},{key:"trigger_tinymce_save",value:function(){var e=(tinyMCE||{}).triggerSave;e&&e()}},{key:"is_post_dirty",value:function(){return i().autosave.server.postChanged()}}])&&le(t.prototype,n),o&&le(t,o),Object.defineProperty(t,"prototype",{writable:!1}),u}(oe);function ye(e){return ye="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ye(e)}function he(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(o=r.key,i=void 0,i=function(e,t){if("object"!==ye(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==ye(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(o,"string"),"symbol"===ye(i)?i:String(i)),r)}var o,i}function ge(e,t){return ge=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},ge(e,t)}function ve(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=me(e);if(t){var o=me(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===ye(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function me(e){return me=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},me(e)}const be=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ge(e,t)}(u,e);var t,n,o,a=ve(u);function u(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),(e=a.call(this)).init(),e}return t=u,(n=[{key:"init",value:function(){this.hook_change_listener(),this.register_api_fetch_middleware()}},{key:"get_data",value:function(){var e=new r,t=this.get_editor(),n=t.getEditedPostAttribute("id");return n||(n=c()("#post_ID").val()||0),e=e.set_id(n).set_type(t.getEditedPostAttribute("type")).set_author_id(t.getEditedPostAttribute("author")).set_title(t.getEditedPostAttribute("title")).set_content(t.getEditedPostAttribute("content")).set_excerpt(t.getEditedPostAttribute("excerpt")).set_slug(t.getEditedPostAttribute("slug")).set_date(new Date(t.getEditedPostAttribute("date"))).set_modified(new Date(t.getEditedPostAttribute("modified"))).set_permalink(t.getPermalink()),"post"===this.get_post_type()?e.set_category_ids(t.getEditedPostAttribute("categories")).set_tag_ids(t.getEditedPostAttribute("tags")):this.get_taxonomies().forEach((function(n){var r=t.getEditedPostAttribute(n);r&&e.set_taxonomy_terms(n,r)})),e}},{key:"get_post_type",value:function(){return p.get("post_type","metabox")}},{key:"get_taxonomies",value:function(){return p.get("taxonomies","metabox")}},{key:"get_editor",value:function(){return i().data.select("core/editor")}},{key:"dispatch_content_change_event",value:function(){this.dispatchEvent(new Event("content-change"))}},{key:"dispatch_editor",value:function(){return i().data.dispatch("core/editor")}},{key:"hook_change_listener",value:function(){var e=this,t=s().debounce((function(){return e.dispatch_content_change_event()}),2e3);i().data.subscribe((function(){e.is_post_loaded()&&e.get_editor().isEditedPostDirty()&&!e.get_editor().isAutosavingPost()&&!e.get_editor().isSavingPost()&&t()}))}},{key:"register_api_fetch_middleware",value:function(){var e=this;i().apiFetch.use((function(t,n){var r=n(t);return r.then((function(){(e.is_autosave_request(t)||e.is_post_save_request(t))&&e.dispatch_autosave_event()})).catch((function(){e.dispatch_autosave_event()})),r}))}},{key:"dispatch_autosave_event",value:function(){this.dispatchEvent(new Event("autosave"))}},{key:"is_autosave_request",value:function(e){return e&&e.path&&e.path.includes("/autosaves")}},{key:"is_post_save_request",value:function(e){var t=this.get_data(),n=t.get_id(),r=t.get_type();return e&&e.path&&"PUT"===e.method&&e.path.includes("/"+n)&&e.path.includes("/"+r)}},{key:"autosave",value:function(){this.get_editor().isEditedPostAutosaveable()?this.dispatch_editor().autosave():this.dispatch_autosave_event()}},{key:"is_post_loaded",value:function(){return this.get_editor().getCurrentPostId&&this.get_editor().getCurrentPostId()}},{key:"is_post_dirty",value:function(){return this.is_post_loaded()&&this.get_editor().isEditedPostDirty()}}])&&he(t.prototype,n),o&&he(t,o),Object.defineProperty(t,"prototype",{writable:!1}),u}(oe);function we(e){return we="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},we(e)}function ke(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(o=r.key,i=void 0,i=function(e,t){if("object"!==we(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==we(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(o,"string"),"symbol"===we(i)?i:String(i)),r)}var o,i}const Ee=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.authors={},this.taxonomy_terms={},this.register_api_fetch_middleware()}var t,n,r;return t=e,n=[{key:"key",value:function(e,t){return e+(t=""+t).trim()}},{key:"add_categories",value:function(e){this.add_taxonomy_terms("category",e)}},{key:"get_categories",value:function(e){return this.get_taxonomy_terms("category",e)}},{key:"add_tags",value:function(e){this.add_taxonomy_terms("post_tag",e),this.add_taxonomy_terms("post_tag",e,"name")}},{key:"get_tags",value:function(e){return this.get_taxonomy_terms("post_tag",e)}},{key:"author_key",value:function(e){return this.key("author-",e)}},{key:"add_authors",value:function(e){var t=this;Array.isArray(e)?e.forEach((function(e){t.add_author(e)})):e.id&&this.add_author(e)}},{key:"add_author",value:function(e){var t=this.author_key(e.id);this.authors[t]=e}},{key:"get_author",value:function(e){var t=this.author_key(e);return!!this.authors.hasOwnProperty(t)&&this.authors[t]}},{key:"get_query_var",value:function(e,t){for(var n=e.substring(1).split(/[&?]/),r=0;r<n.length;r++){var o=n[r].split("=");if(decodeURIComponent(o[0])===t)return decodeURIComponent(o[1])}return!1}},{key:"register_api_fetch_middleware",value:function(){var e=this;i().apiFetch.use((function(t,n){if(e.is_term_request(t)){var r=e.get_query_var(t.path,"_fields");r&&(t.path=t.path.replace(encodeURIComponent(r),encodeURIComponent(r+",description")))}var o=n(t);return o.then((function(n){e.is_category_request(t)&&e.add_categories(n),e.is_tag_request(t)&&e.add_tags(n),e.is_get_request(t,"/wp/v2/users/")&&e.add_authors(n);var r=e.get_taxonomy_slug(t);r&&e.add_taxonomy_terms(r,n)})).catch((function(e){console.log(e)})),o}))}},{key:"get_taxonomy_slug",value:function(e){if(e.method&&"GET"!==e.method||!e.path)return!1;var t=this.get_taxonomies(),n=e.path.match(/\/wp\/v2\/([a-z_-]*).*/);return!(!n||n.length<2||!n[1])&&!!t.includes(n[1])&&n[1]}},{key:"is_term_request",value:function(e){return this.is_category_request(e)||this.is_tag_request(e)||!!this.get_taxonomy_slug(e)}},{key:"is_category_request",value:function(e){return this.is_get_request(e,"/wp/v2/categories")}},{key:"is_tag_request",value:function(e){return this.is_get_request(e,"/wp/v2/tags")}},{key:"is_get_request",value:function(e,t){return e&&(!e.method||"GET"===e.method)&&e.path&&e.path.includes(t)}},{key:"taxonomy_key",value:function(e,t){return this.key("taxonomy-"+e+"-term-",t)}},{key:"get_taxonomy_terms",value:function(e,t){var n=this,r=[];return t.forEach((function(t){var o=n.taxonomy_key(e,t);n.taxonomy_terms.hasOwnProperty(o)&&r.push(n.taxonomy_terms[o])})),r.length!==t.length?[]:r}},{key:"add_taxonomy_terms",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"id";Array.isArray(t)?t.forEach((function(t){n.add_taxonomy_term(e,t,r)})):t.id&&this.add_taxonomy_term(e,t,r)}},{key:"add_taxonomy_term",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"id",r=this.taxonomy_key(e,t[n]);this.taxonomy_terms[r]=t}},{key:"get_taxonomies",value:function(){return p.get("taxonomies","replacement")}}],n&&ke(t.prototype,n),r&&ke(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function Pe(e){return Pe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Pe(e)}function Oe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(o=r.key,i=void 0,i=function(e,t){if("object"!==Pe(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==Pe(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(o,"string"),"symbol"===Pe(i)?i:String(i)),r)}var o,i}const Se=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.cache=t,this.category_promise=null,this.tag_promise=null,this.author_promise=null,this.term_promise={}}var t,n,r;return t=e,(n=[{key:"fetch_category_data",value:function(e){var t=this;return this.category_promise||(this.category_promise=new Promise((function(n,r){if(e&&e.length){var o=t.cache.get_categories(e);if(o.length)n(o);else{var a="/wp/v2/categories?"+c().param({include:e});i().apiFetch({path:a}).then((function(e){n(e)})).catch(r)}}else n([])})),this.category_promise.then((function(){t.category_promise=null}))),this.category_promise}},{key:"fetch_tag_data",value:function(e){var t=this;return this.tag_promise||(this.tag_promise=new Promise((function(n,r){if(e&&e.length){var o={};if(t.ids_numeric(e))o.include=e;else{if(!t.ids_slugs(e))return void r("IDs malformed");o.slug=e}var a=t.cache.get_tags(e);if(a.length)n(a);else{var s="/wp/v2/tags?"+c().param(o);i().apiFetch({path:s}).then((function(e){n(e)})).catch(r)}}else n([])})),this.tag_promise.then((function(){t.tag_promise=null}))),this.tag_promise}},{key:"fetch_taxonomy_terms",value:function(e,t){var n=this;return this.term_promise.hasOwnProperty(e)||(this.term_promise[e]=new Promise((function(r,o){if(t&&t.length){var a=n.cache.get_taxonomy_terms(e,t);if(a.length)r(a);else{var s=c().param({include:t}),u="/wp/v2/"+e+"?"+s;i().apiFetch({path:u}).then((function(e){r(e)})).catch(o)}}else r([])})),this.term_promise[e].then((function(){delete n.term_promise[e]}))),this.term_promise[e]}},{key:"fetch_author_data",value:function(e){var t=this;return this.author_promise||(this.author_promise=new Promise((function(n,r){if(e){var o=t.cache.get_author(e);if(o)n(o);else{var a="/wp/v2/users/"+e;i().apiFetch({path:a}).then((function(e){n(e)})).catch(r)}}else n(!1)})),this.author_promise.then((function(){t.author_promise=null}))),this.author_promise}},{key:"ids_numeric",value:function(e){return!!Array.isArray(e)&&e.reduce((function(e,t){var n=!isNaN(t);return e&&n}),!0)}},{key:"ids_slugs",value:function(e){return!!Array.isArray(e)&&e.reduce((function(e,t){var n=isNaN(t);return e&&n}),!0)}}])&&Oe(t.prototype,n),r&&Oe(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function je(e){return je="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},je(e)}function xe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(o=r.key,i=void 0,i=function(e,t){if("object"!==je(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==je(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(o,"string"),"symbol"===je(i)?i:String(i)),r)}var o,i}const Re=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"truncate_string",value:function(e,t){return e.length>t&&(e=Array.from(e).splice(0,t-4).join("").trim()+" ..."),e}},{key:"normalize_whitespace",value:function(e){return(e=(e=e.replace(/(\r\n|\n|\r|\t)/gm," ")).replace(/ +/g," ")).trim()}},{key:"remove_shortcodes",value:function(e){if(-1===(e=e||"").indexOf("["))return e;var t=this;return e.replace(/\[(\[?)([a-zA-Z0-9_-]*)(?![\w-])([^\]\/]*(?:\/(?!])[^\]\/]*)*?)(?:(\/)]|](?:([^\[]*(?:\[(?!\/\2])[^\[]*)*)\[\/\2])?)(]?)/g,(function(e,n,r,o,i,a,s,u,c){if(arguments.length<7)return e||"";if("["===n&&"]"===s)return e.substring(1,e.length-1);var l=p.get("omitted_shortcodes","replacement");return a&&!l.includes(r)?t.remove_shortcodes(a.trim()):""}))}},{key:"strip_html",value:function(e){e=(e=e.toString()).replace(/(<([^>]+)>)/gi,"");var t=document.createElement("DIV");return t.innerHTML=e,t.textContent||t.innerText||""}},{key:"process_string",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return t=e.strip_html(t),t=e.normalize_whitespace(t),n&&(t=e.truncate_string(t,n)),t}}],(n=null)&&xe(t.prototype,n),r&&xe(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function Te(e){return Te="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Te(e)}function Ae(e){return function(e){if(Array.isArray(e))return Ie(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return Ie(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ie(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ie(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Ce(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(o=r.key,i=void 0,i=function(e,t){if("object"!==Te(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==Te(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(o,"string"),"symbol"===Te(i)?i:String(i)),r)}var o,i}var De=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.fetcher=t}var t,n,r;return t=e,n=[{key:"format_date",value:function(e,t){return i().date.dateI18n(t,e)}},{key:"get_excerpt_or_trimmed_content",value:function(e){return this.get_trimmed_excerpt(e.get_excerpt(),e.get_content())}},{key:"get_trimmed_excerpt",value:function(e,t){var n=e||t,r=p.get("metadesc_max_length","replacement");n=Re.strip_html(n);var o=(n=Re.normalize_whitespace(n)).indexOf("[");return-1!==o&&o<r&&(n=Re.remove_shortcodes(n)),this.truncate_meta_description(n,r)}},{key:"truncate_meta_description",value:function(e,t){return Re.truncate_string(e,t)}},{key:"replace_term_macros",value:function(e,t){var n={"%%id%%":t.get_id(),"%%term_title%%":t.get_title(),"%%term_description%%":t.get_description()};return"category"===t.get_taxonomy()?(n["%%category%%"]=t.get_title(),n["%%category_description%%"]=t.get_description()):"post_tag"===t.get_taxonomy()&&(n["%%tag%%"]=t.get_title(),n["%%tag_description%%"]=t.get_description()),this.do_replace(e,{},n)}},{key:"replace",value:function(e,t){var n=this,r=this.fetcher,o={"%%name%%":function(){return new Promise((function(e,n){r.fetch_author_data(t.get_author_id()).then((function(t){var n=t&&t.name?t.name:"";e({"%%name%%":n})})).catch(n)}))},"%%category%%":function(e){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"name",i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return new Promise((function(a,s){r.fetch_category_data(t.get_category_ids()).then((function(t){var r=n.get_term_macro_value(t,o,i),s={};e&&e.length&&(s[e[0]]=r),a(s)})).catch(s)}))},"%%tag%%":function(e){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"name",i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return new Promise((function(a,s){r.fetch_tag_data(t.get_tag_ids()).then((function(t){var r=n.get_term_macro_value(t,o,i),s={};e&&e.length&&(s[e[0]]=r),a(s)})).catch(s)}))},"%%ct_(desc_){0,1}([a-z_-]*)%%":function(e){var i="name";3===e.length&&"desc_"===e[1]&&(i="description");var a=e[2];return"category"===a?(0,o["%%category%%"])(e,i,!0):"post_tag"===a?(0,o["%%tag%%"])(e,i,!0):new Promise((function(o,s){r.fetch_taxonomy_terms(a,t.get_taxonomy_terms(a)).then((function(t){var r=n.get_term_macro_value(t,i,!0),a={};e&&e.length&&(a[e[0]]=r),o(a)})).catch(s)}))}};return this.do_replace(e,o,{"%%id%%":t.get_id(),"%%title%%":t.get_title(),"%%excerpt%%":this.get_excerpt_or_trimmed_content(t),"%%excerpt_only%%":t.get_excerpt(),"%%modified%%":this.format_date(t.get_modified(),"Y-m-d H:i:s"),"%%date%%":this.format_date(t.get_date(),this.get_date_format()),"%%userid%%":t.get_author_id(),"%%caption%%":t.get_excerpt()})}},{key:"do_replace",value:function(e,t,n){var r=this,o=[];return Object.keys(t).forEach((function(n){var r=t[n],i=Ae(e.matchAll(n));i&&i.length&&i.forEach((function(e){e&&e.length&&o.push(r(e))}))})),new Promise((function(t,i){Promise.all(o).then((function(o){o.push(n),o.push(r.get_general_replacements());var i=o.reduce((function(e,t){return Object.assign(e,t)}),{});Object.keys(i).forEach((function(t){var n=new RegExp(t,"g");e=e.replace(n,i[t])}));var a=new RegExp("%%[a-zA-Z_]*%%","g");e=e.replace(a,""),t(e)})).catch(i)}))}},{key:"get_term_macro_value",value:function(e,t,n){Array.isArray(e)||(e=[]);var r=(e=s().sortBy(e,(function(e){return e.name}))).reduce((function(e,n){return n.hasOwnProperty(t)&&e.push(n[t]),e}),[]);return n&&r.length?r[0]:r.join(", ")}},{key:"get_general_replacements",value:function(){var e=p.get("time_format","replacement");return{"%%sep%%":this.get_global("sep"),"%%sitename%%":this.get_global("sitename"),"%%sitedesc%%":this.get_global("sitedesc"),"%%page%%":this.get_global("page"),"%%pagetotal%%":this.get_global("pagetotal"),"%%pagenumber%%":this.get_global("pagenumber"),"%%spell_pagenumber%%":this.get_global("spell_pagenumber"),"%%spell_pagetotal%%":this.get_global("spell_pagetotal"),"%%spell_page%%":this.get_global("spell_page"),"%%currenttime%%":this.format_date(new Date,e),"%%currentdate%%":this.format_date(new Date,this.get_date_format()),"%%currentmonth%%":this.format_date(new Date,"F"),"%%currentyear%%":this.format_date(new Date,"Y")}}},{key:"get_date_format",value:function(){return p.get("date_format","replacement")}},{key:"get_global",value:function(e){return p.get(["replacements",e],"replacement")}}],n&&Ce(t.prototype,n),r&&Ce(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();const Ne=De,Be=Wds;var Fe=e.n(Be);function Le(e,t){return Le=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Le(e,t)}function We(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ue(e);if(t){var o=Ue(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===qe(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function Ue(e){return Ue=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Ue(e)}function qe(e){return qe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},qe(e)}function Me(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ve(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(o=r.key,i=void 0,i=function(e,t){if("object"!==qe(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==qe(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(o,"string"),"symbol"===qe(i)?i:String(i)),r)}var o,i}function $e(e,t,n){return t&&Ve(e.prototype,t),n&&Ve(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var Ge=function(){function e(){Me(this,e)}return $e(e,null,[{key:"get_title",value:function(){return c()("#wds_title").val()}},{key:"get_description",value:function(){return c()("#wds_metadesc").val()}},{key:"preview_loading",value:function(e){var t=this.get_preview_el().find(".wds-preview-container"),n="wds-preview-loading";e?t.addClass(n):t.removeClass(n)}},{key:"get_preview_el",value:function(){return c()(".wds-metabox-preview")}},{key:"replace_preview_markup",value:function(e){this.get_preview_el().replaceWith(e)}},{key:"set_title_placeholder",value:function(e){c()("#wds_title").prop("placeholder",e)}},{key:"set_desc_placeholder",value:function(e){c()("#wds_metadesc").prop("placeholder",e)}}]),e}();const He=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Le(e,t)}(n,e);var t=We(n);function n(e,r){var o;return Me(this,n),(o=t.call(this)).editor=e,o.macroReplacement=r,o.init(),o}return $e(n,[{key:"init",value:function(){var e=this;this.editor.addEventListener("autosave",(function(t){return e.handle_autosave_event(t)})),this.editor.addEventListener("content-change",(function(t){return e.handle_content_change_event(t)})),c()(document).on("input propertychange",".wds-meta-field",s().debounce((function(t){return e.handle_meta_change(t)}),200)).on("input propertychange",".wds-meta-field",s().debounce((function(t){return e.dispatch_meta_change_deferred_event(t)}),2e3)),c()(window).on("load",(function(){return e.handle_page_load()}))}},{key:"handle_autosave_event",value:function(){this.refresh_preview(),this.refresh_placeholders()}},{key:"handle_content_change_event",value:function(){this.refresh_preview(),this.refresh_placeholders()}},{key:"handle_meta_change",value:function(){this.dispatch_meta_change_event(),this.refresh_preview()}},{key:"handle_page_load",value:function(){this.refresh_preview(),this.refresh_placeholders()}},{key:"refresh_preview",value:function(){Ge.preview_loading(!0);var e=Ge.get_title()||p.get("meta_title","metabox"),t=Ge.get_description()||p.get("meta_desc","metabox"),r=this.editor.get_data(),o=[];o.push(this.macroReplacement.replace(e,r)),o.push(this.macroReplacement.replace(t,r)),Promise.all(o).then((function(e){Ge.preview_loading(!1);var t=Fe().tpl_compile(Fe().template("metabox","preview")),o=p.get("title_max_length","metabox"),i=p.get("metadesc_max_length","metabox"),a=t({link:r.get_permalink(),title:n.prepare_string(e[0],o),description:n.prepare_string(e[1],i)});Ge.replace_preview_markup(a)})).catch((function(e){console.log(e)}))}},{key:"refresh_placeholders",value:function(){var e=this.editor.get_data();Promise.all([this.macroReplacement.replace(p.get("meta_title","metabox"),e),this.macroReplacement.replace(p.get("meta_desc","metabox"),e)]).then((function(e){Ge.set_title_placeholder(n.prepare_string(e[0])),Ge.set_desc_placeholder(n.prepare_string(e[1]))})).catch((function(e){console.log(e)}))}},{key:"dispatch_meta_change_event",value:function(){this.dispatchEvent(new Event("meta-change"))}},{key:"dispatch_meta_change_deferred_event",value:function(){this.dispatchEvent(new Event("meta-change-deferred"))}},{key:"post",value:function(e,t){return t=c().extend({action:e,_wds_nonce:p.get("nonce","metabox")},t),c().post(ajaxurl,t)}}],[{key:"prepare_string",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return Re.process_string(e,t)}}]),n}(oe);function ze(e,t){return ze=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},ze(e,t)}function Ye(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Qe(e);if(t){var o=Qe(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===Ze(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function Qe(e){return Qe=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Qe(e)}function Ze(e){return Ze="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ze(e)}function Xe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ke(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(o=r.key,i=void 0,i=function(e,t){if("object"!==Ze(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==Ze(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(o,"string"),"symbol"===Ze(i)?i:String(i)),r)}var o,i}function Je(e,t,n){return t&&Ke(e.prototype,t),n&&Ke(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var et=function(){function e(){Xe(this,e)}return Je(e,null,[{key:"get_focus_keyword_el",value:function(){return c()("#wds_focus")}},{key:"get_focus_keyword_input_el",value:function(){return c()("#wds_focus_input")}},{key:"get_focus_keyword",value:function(){return this.get_focus_keyword_el().val()}},{key:"get_title",value:function(){return c()("#wds_title").val()}},{key:"get_description",value:function(){return c()("#wds_metadesc").val()}},{key:"get_metabox_el",value:function(){return c()("#wds-wds-meta-box")}},{key:"get_seo_report_el",value:function(){return c()(".wds-seo-analysis",this.get_seo_analysis_el())}},{key:"get_readability_report_el",value:function(){return c()(".wds-readability-report",this.get_readability_analysis_el())}},{key:"get_postbox_fields_el",value:function(){return c()(".wds-post-box-fields")}},{key:"replace_seo_report",value:function(e){this.get_seo_report_el().replaceWith(e)}},{key:"replace_readability_report",value:function(e){this.get_readability_report_el().replaceWith(e)}},{key:"replace_post_fields",value:function(e){this.get_postbox_fields_el().replaceWith(e)}},{key:"get_refresh_button_el",value:function(){return c()(".wds-refresh-analysis",this.get_metabox_el())}},{key:"update_refresh_button",value:function(e){this.get_refresh_button_el().prop("disabled",!e)}},{key:"get_seo_error_count",value:function(){return this.get_seo_report_el().data("errors")}},{key:"get_readability_state",value:function(){return this.get_readability_report_el().data("readabilityState")}},{key:"get_seo_analysis_el",value:function(){return c()(".wds-seo-analysis-container",this.get_metabox_el())}},{key:"get_readability_analysis_el",value:function(){return c()(".wds-readability-analysis-container",this.get_metabox_el())}},{key:"block_ui",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.get_analysis_containers();e?e.addClass(e.is("button")?"sui-button-onload":"wds-item-loading"):(c()(".wds-report-inner",t).hide(),c()(".wds-seo-analysis",t).hide(),c()(".wds-analysis-working",t).show()),c()(".wds-disabled-during-request",t).prop("disabled",!0),c()("#wds_add_keyword").prop("disabled",!0),c()("#wds_add_keyword").addClass("sui-button-onload-text"),c()("#wds-added-keywords-tags").hide()}},{key:"unblock_ui",value:function(){var e=this.get_analysis_containers();c()(".wds-item-loading",e).removeClass("wds-item-loading"),c()(".sui-button-onload",e).removeClass("sui-button-onload"),c()(".wds-report-inner",e).show(),c()(".wds-seo-analysis",e).show(),c()(".wds-analysis-working",e).hide(),c()(".wds-disabled-during-request",e).prop("disabled",!1),c()("#wds_add_keyword").prop("disabled",!1).removeClass("sui-button-onload-text"),c()("#wds-added-keywords-tags").show()}},{key:"get_analysis_containers",value:function(){return c()(".wds-seo-analysis-container, .wds-readability-analysis-container",this.get_metabox_el())}},{key:"update_focus_field_state",value:function(e){this.get_focus_container_el().removeClass("wds-focus-keyword-loaded wds-focus-keyword-invalid").addClass(e?"wds-focus-keyword-loaded":"wds-focus-keyword-invalid")}},{key:"get_focus_container_el",value:function(){return c()(".wds-focus-keyword")}}]),e}();const tt=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ze(e,t)}(n,e);var t=Ye(n);function n(e,r){var o;return Xe(this,n),(o=t.call(this)).editor=e,o.metaboxOnpage=r,o.init(),o}return Je(n,[{key:"init",value:function(){var e=this;this.editor.addEventListener("autosave",(function(){e.refresh_analysis(!0)})),c()(document).on("click",".wds-refresh-analysis",(function(t){return e.handle_refresh_click(t)})).on("click",".wds-seo-analysis-container .wds-ignore",(function(t){return e.handle_ignore_click(t)})).on("click",".wds-seo-analysis-container .wds-unignore",(function(t){return e.handle_unignore_click(t)})).on("click",".wds-readability-analysis-container .wds-ignore",(function(t){return e.handle_ignore_click(t)})).on("click",".wds-readability-analysis-container .wds-unignore",(function(t){return e.handle_unignore_click(t)})).on("click",".wds-seo-analysis-container #wds_add_keyword",(function(t){return e.handle_focus_keywords_add(t)})).on("click",".wds-seo-analysis-container .wds-remove-keyword",(function(t){return e.handle_focus_keywords_remove(t)})),c()(window).on("load",(function(){return e.hook_meta_change_listener()})).on("load",(function(){return e.handle_page_load()}))}},{key:"refresh_analysis",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=et.get_focus_keyword();return this.post("wds-analysis-get-editor-analysis",{post_id:this.editor.get_data().get_id(),is_dirty:t||this.editor.is_post_dirty()?1:0,wds_title:et.get_title(),wds_description:et.get_description(),wds_focus_keywords:n}).done((function(t){if(!(t||{}).success)return!1;var n=(t||{}).data,r=(n||{}).seo||"",o=(n||{}).readability||"",i=(n||{}).postbox_fields||"",a=(n||{}).keyword_tags||"",s=(n||{}).focus_keywords||"";"false"===s&&(s=""),et.replace_seo_report(r),et.replace_readability_report(o),et.replace_post_fields(i),c()("#wds-added-keywords-tags").html(a),et.get_focus_keyword_el().val(s);var u=et.get_seo_error_count(),l=et.get_readability_state();e.dispatch_seo_update_event(u),e.dispatch_readability_update_event(l)})).always((function(){et.unblock_ui();var t=!(!n||!n.length);et.update_focus_field_state(t),et.update_refresh_button(!0),e.toggle_keyword_button()}))}},{key:"add_keyword",value:function(){var e=this,t=et.get_focus_keyword_input_el().val();return this.post("wds-analysis-add-keyword",{post_id:this.editor.get_data().get_id(),keyword:t}).done((function(e){if(!(e||{}).success)return et.unblock_ui(),!1;et.get_focus_keyword_el().val(e.data)})).always((function(){et.get_focus_keyword_input_el().val(""),e.refresh_analysis()}))}},{key:"remove_keyword",value:function(e){var t=this;return this.post("wds-analysis-remove-keyword",{post_id:this.editor.get_data().get_id(),keyword:e}).done((function(e){if(!(e||{}).success)return et.unblock_ui(),!1;et.get_focus_keyword_el().val(e.data)})).always((function(){t.refresh_analysis()}))}},{key:"handle_refresh_click",value:function(e){this.prevent_default(e),this.dispatch_event("before-analysis-refresh"),et.block_ui(),this.editor.autosave()}},{key:"handle_ignore_click",value:function(e){var t=this;this.prevent_default(e);var n=c()(e.target).closest("button"),r=n.attr("data-check_id");return et.block_ui(n),this.change_ignore_status(r,!0).done((function(){return t.refresh_analysis()}))}},{key:"handle_unignore_click",value:function(e){var t=this;this.prevent_default(e);var n=c()(e.target).closest("button"),r=n.attr("data-check_id");return et.block_ui(n),this.change_ignore_status(r,!1).done((function(){return t.refresh_analysis()}))}},{key:"handle_focus_keywords_add",value:function(){this.dispatch_event("before-focus-keyword-add"),et.block_ui(!1),this.add_keyword()}},{key:"handle_focus_keywords_remove",value:function(e){var t=c()(e.target).attr("data-keyword");t.length>0&&(this.dispatch_event("before-focus-keyword-remove"),et.block_ui(),this.remove_keyword(t))}},{key:"hook_meta_change_listener",value:function(){var e=this,t=this.metaboxOnpage;t&&t.addEventListener("meta-change-deferred",(function(){return e.refresh_analysis()}))}},{key:"handle_page_load",value:function(){this.dispatch_event("before-analysis-refresh"),et.block_ui(),this.refresh_analysis()}},{key:"toggle_keyword_button",value:function(){var e=et.get_focus_keyword_el().val();e.length>0&&e.split(",").length>2?c()("#wds_add_keyword").prop("disabled",!0):c()("#wds_add_keyword").prop("disabled",!1)}},{key:"post",value:function(e,t){return t=c().extend({action:e,_wds_nonce:p.get("nonce","metabox")},t),c().post(ajaxurl,t)}},{key:"change_ignore_status",value:function(e,t){this.dispatch_event("before-ignore-status-change");var n=t?"wds-analysis-ignore-check":"wds-analysis-unignore-check";return this.post(n,{post_id:this.editor.get_data().get_id(),check_id:e})}},{key:"prevent_default",value:function(e){e&&e.preventDefault&&e.stopPropagation&&(e.preventDefault(),e.stopPropagation())}},{key:"dispatch_event",value:function(e){this.dispatchEvent(new Event(e))}},{key:"dispatch_seo_update_event",value:function(e){var t=new CustomEvent("after-seo-analysis-update",{detail:{errors:e}});this.dispatchEvent(t)}},{key:"dispatch_readability_update_event",value:function(e){var t=new CustomEvent("after-readability-analysis-update",{detail:{state:e}});this.dispatchEvent(t)}}]),n}(oe);function nt(e){return nt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},nt(e)}function rt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(o=r.key,i=void 0,i=function(e,t){if("object"!==nt(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==nt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(o,"string"),"symbol"===nt(i)?i:String(i)),r)}var o,i}var ot=function(){function e(t,n,r){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.is_field_valid(t)){this.$el=t,this.macroReplacementFunction=n,this.upper=r.upper||0,this.lower=r.lower||0,this.default_value=r.default_value||"";var o=.08*this.upper;this.almost_lower=this.lower+o,this.almost_upper=this.upper-o,this.init_element(t),this.init_listeners(),this.update_indicator()}}var t,n,r;return t=e,(n=[{key:"init_listeners",value:function(){var e=this;this.$el.on("input propertychange",_.debounce((function(){return e.update_indicator()}),200)).one("input propertychange",(function(){return e.add_resolving_class()}))}},{key:"is_field_valid",value:function(e){return!e.is(this.field_selector())&&e.is("input,textarea")}},{key:"init_element",value:function(e){return e.addClass(this.field_class()),c()("<div><span></span><span></span></div>").addClass(this.indicator_class()).insertAfter(e),e}},{key:"get_indicator",value:function(){return this.$el.next(this.indicator_selector())}},{key:"get_bar",value:function(){return this.get_indicator().find("span").first()}},{key:"get_char_count_container",value:function(){return this.get_indicator().find("span").last()}},{key:"reset_classes",value:function(){this.$el.removeClass("over almost-over just-right almost-under under")}},{key:"remove_resolving_class",value:function(){this.$el.removeClass("resolving")}},{key:"add_resolving_class",value:function(){this.$el.addClass("resolving")}},{key:"update_indicator",value:function(){var e=this,t=this.$el.val();if(!(t=t||this.default_value))return this.get_char_count_container().hide(),this.reset_classes(),void this.remove_resolving_class();this.macroReplacementFunction(t).then((function(t){t=Re.strip_html(t),t=Re.normalize_whitespace(t);var n=Array.from(t).length,r=n/((e.upper+e.lower)/2)*100;e.remove_resolving_class(),e.$el.one("input propertychange",(function(){return e.add_resolving_class()})),r=(r/=2)>100?100:r,e.get_bar().width(r+"%");var o=e.get_char_count_container();o.html(n+" / "+e.lower+"-"+e.upper+" "+p.get(["strings","characters"],"admin")),n?o.show():o.hide(),e.reset_classes(),n>e.upper?e.$el.addClass("over"):e.almost_upper<n&&n<=e.upper?e.$el.addClass("almost-over"):e.almost_lower<=n&&n<=e.almost_upper?e.$el.addClass("just-right"):e.lower<=n&&n<e.almost_lower?e.$el.addClass("almost-under"):e.lower>n&&e.$el.addClass("under")}))}},{key:"field_class",value:function(){return"wds-optimum-length-indicator-field"}},{key:"field_selector",value:function(){return"."+this.field_class()}},{key:"indicator_class",value:function(){return"wds-optimum-length-indicator"}},{key:"indicator_selector",value:function(){return"."+this.indicator_class()}}])&&rt(t.prototype,n),r&&rt(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();!function(){var e;e=p.get_bool("gutenberg_active","metabox")?new be:new pe;var t=new Ee,n=new Se(t),r=new Ne(n),o=!1;p.get_bool("onpage_active","metabox")&&(o=new He(e,r));var i=!1;p.get_bool("analysis_active","metabox")&&(i=new tt(e,o)),window.Wds=window.Wds||{},window.Wds.postEditor=e,window.Wds.metaboxAnalysis=i,window.Wds.metaboxOnpage=o,window.Wds.stringUtils=Re,window.Wds.OptimumLengthIndicator=ot}(jQuery)})();